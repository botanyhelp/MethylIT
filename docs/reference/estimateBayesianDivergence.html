<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Information divergence estimator — estimateBayesianDivergence • MethylIT</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Information divergence estimator — estimateBayesianDivergence" />
<meta property="og:description" content="The Information divergence of methylation levels is estimated
using the direct estimation or a Bayesian approach of the methylation
levels. Hellinger divergence is computed as given in reference 1." />
<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MethylIT</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/MethylIT.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/cancer_example.html">Example of Methylome Analysis with MethylIT using Cancer Datasets</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Information divergence estimator</h1>
    
    <div class="hidden name"><code>estimateBayesianDivergence.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The Information divergence of methylation levels is estimated
using the direct estimation or a Bayesian approach of the methylation
levels. Hellinger divergence is computed as given in reference 1.</p>
    </div>

    <pre class="usage"><span class='fu'>estimateBayesianDivergence</span>(
  <span class='no'>x</span>,
  <span class='kw'>Bayesian</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>JD</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>num.cores</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>tasks</span> <span class='kw'>=</span> <span class='fl'>0L</span>,
  <span class='kw'>columns</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>mC1</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>uC1</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>mC2</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>uC2</span> <span class='kw'>=</span> <span class='fl'>4</span>),
  <span class='kw'>meth.level</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>preserve.gr</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>logbase</span> <span class='kw'>=</span> <span class='fl'>2</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A matrix of counts or GRanges object with the table of counts in
the meta-columns (methylated mC and unmethylated uC cytosines). Unless
specified in the parameter 'columns', the methylation counts must be
given in the first four columns: "mC1" and "uC1" methylated and
unmethylated counts for control sample, and "mC2" and "uC2" methylated
and unmethylated counts for treatment sample, respectively.</p></td>
    </tr>
    <tr>
      <th>Bayesian</th>
      <td><p>logical. Whether to perform the estimations based on
posterior estimations of methylation levels.</p></td>
    </tr>
    <tr>
      <th>JD</th>
      <td><p>Logic (Default:FALSE). Option on whether to add a column with
values of J-information divergence (see <code><a href='estimateJDiv.html'>estimateJDiv</a></code>).
It is only compute if JD = TRUE and meth.level = FALSE.</p></td>
    </tr>
    <tr>
      <th>num.cores</th>
      <td><p>The number of cores to use, i.e. at most how many child
processes will be run simultaneously (see 'bplapply' function from
BiocParallel package).</p></td>
    </tr>
    <tr>
      <th>tasks</th>
      <td><p>integer(1). The number of tasks per job. value must be a scalar
integer &gt;= 0L. In this documentation a job is defined as a single call
to a function, such as bplapply, bpmapply etc. A task is the division of
the X argument into chunks. When tasks == 0 (default), X is divided as
evenly as possible over the number of workers (see MulticoreParam from
BiocParallel package).</p></td>
    </tr>
    <tr>
      <th>columns</th>
      <td><p>Vector of integer numbers of the columns where the counts
"mC1", "uC1", "mC2", and "uC2" are in the matrix (default 1 to 4). That
is, the input could have more than 4 columns, but only 4 columns with
the counts are used.</p></td>
    </tr>
    <tr>
      <th>meth.level</th>
      <td><p>methylation levels can be provided in place of counts.</p></td>
    </tr>
    <tr>
      <th>preserve.gr</th>
      <td><p>Logic (Default:FALSE). Option of whether to preserve all
the metadata from the original GRange object.</p></td>
    </tr>
    <tr>
      <th>logbase</th>
      <td><p>Logarithm base used to compute the JD (if JD = TRUE).
Logarithm base 2 is used as default (bit unit). Use logbase = exp(1) for
natural logarithm.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>if TRUE, prints the function log to stdout</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The input matrix or GRanges object with the four columns of counts
and additional columns. If Bayessian = TRUE, the results are based on
the posterior estimations of methylation levels. 1) p1" and "p2":
methylation levels for control and treatment; 2) "hdiv": Hellinger
divergence; 3) "bay.TV". "TV": total variation TV = p2 - p1 is based
on simple counts</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>For the current version, the Information divergence of methylation
levels is estimated based on Hellinger divergence. If read counts are
provided, then Hellinger divergence is computed as given in the first
formula from Theorem 1 from reference 1. In the present case,</p><pre>hdiv = 2*(n[1] + 1)*(n[2] + 1)*((sqrt(p[1]) - sqrt(p[2]))^2 + (sqrt(1 -
p[1]) - sqrt(1 - p[2]))^2)/(n[1] + n[2] + 2)

where n[1] and n[2] are the coverage for the control and treatment,
respectively. Notice that each row from the matrix of counts correspond
to a single cytosine position and has four values corresponding to "mC1"
and "uC1" (control), and mC2" and "uC2" for treatment.

If the methylation levels are provided in place of counts, then
Hellinger divergence is computed as:
hdiv = (sqrt(p[1]) - sqrt(p[2]))^2 + (sqrt(1 -p[1]) - sqrt(1 - p[2]))^2

This formula assumes that the probability vectors derived from the
methylation levels (p_ij) p_j = c(p_ij, 1 - p_ij) (see function
'estimateHellingerDiv') are an unbiased estimation of the expected one.
</pre>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
<ol>
<li><p>Basu  A., Mandal  A., Pardo L (2010) Hypothesis testing for
two discrete populations based on the Hellinger distance. Stat Probab
Lett 80: 206-214.</p></li>
</ol>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## The read count data are created</span>
    <span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>chr</span> <span class='kw'>=</span> <span class='st'>"chr1"</span>, <span class='kw'>start</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='fl'>10</span>,
                    <span class='kw'>end</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='fl'>10</span>,<span class='kw'>strand</span> <span class='kw'>=</span> <span class='st'>'*'</span>,
                    <span class='kw'>mC1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/NegBinomial.html'>rnbinom</a></span>(<span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>mu</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>500</span>),
                    <span class='kw'>uC1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/NegBinomial.html'>rnbinom</a></span>(<span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>mu</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>500</span>),
                    <span class='kw'>mC2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/NegBinomial.html'>rnbinom</a></span>(<span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>mu</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>500</span>),
                    <span class='kw'>uC2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/NegBinomial.html'>rnbinom</a></span>(<span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>mu</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>500</span>))
    <span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>makeGRangesFromDataFrame</span>(<span class='no'>x</span>, <span class='kw'>keep.extra.columns</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='co'>## Estimation of the information divergences</span>
    <span class='no'>hd</span> <span class='kw'>&lt;-</span> <span class='fu'>estimateBayesianDivergence</span>(<span class='no'>x</span>, <span class='kw'>JD</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; *** Estimating Hellinger divergence... 
#&gt; * Coercing from list to vector...</div><div class='input'>
<span class='co'>## Keep in mind that Hellinger and J divergences are, in general, correlated!</span>
    <span class='fu'><a href='https://rdrr.io/r/stats/cor.test.html'>cor.test</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span>(<span class='no'>hd</span>$<span class='no'>hdiv</span>), <span class='kw'>y</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span>(<span class='no'>hd</span>$<span class='no'>jdiv</span>),
            <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"kendall"</span>)</div><div class='output co'>#&gt; 
#&gt; 	Kendall's rank correlation tau
#&gt; 
#&gt; data:  as.numeric(hd$hdiv) and as.numeric(hd$jdiv)
#&gt; z = 27.624, p-value &lt; 2.2e-16
#&gt; alternative hypothesis: true tau is not equal to 0
#&gt; sample estimates:
#&gt;       tau 
#&gt; 0.8306315 
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Robersy Sanchez</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Robersy Sanchez.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


