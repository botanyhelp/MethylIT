<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Report the Best Fitted Probability Distribution Model — gofReport • MethylIT</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Report the Best Fitted Probability Distribution Model — gofReport" />
<meta property="og:description" content="In Methyl-IT,  the signal detection step requires for the
knowledge of the probability distribution of the methylation noise, which
is the null hypothesis used to discriminate the signal from the noise.
Both, signal and noise, are expressed in terms of an information
divergence of methylation levels, which (currently in Methyl-IT) could be
the Hellinger divergence or the total variation distance.As shown in reference [1], on statistical physics basis, the probability
distribution of the noise is a member of the generalized gamma
distribution. In particular, if the methylation changes on the DNA
molecule follow a Poisson process, then the noise follows a Weibull
probability distribution.

Function 'gofReport' search for the best fitted model betweeen the set
of models requested by the user. Two goodness-of-fit (GoF) criteria are
applied to select the best fitted model: Akaike's information criterion
(AIC) and the correlation coeficient of cross-validations for the
nonlinear regressions (R.Cross.val) [2]. These criteria evaluate
different information inferred from the models. AIC deals with the
trade-off between the goodness of fit of the model and the complexity
of the model, while R.Cross.val provides information on the prediction
power/performance of the model when confronted with external dataset.

Although the numerical algorithms to accomplish the nonlinear fit are not
perfect, in general, the model with the lowest AIC must have the highest
R.Cross.val. If the model with the lowest AIC has not the highest
R.Cross.val, then further analyses are required. These analyses could
include the visualization of the graphics for the density distribution,
evaluation of whether the parameter values can be meaningful or not, etc.
Nevertheless, the best model will, in general, lead to the identification
of the greater amount of potential DMPs and DMPs, as well as, the highest
classification accuracy estimated with functions
\code{\link{estimateCutPoint}} and \code{\link{evaluateDIMPclass}}. In
the worse scenario, these observations can ultimately lead to a post-hoc
decision on which the best model is.

" />
<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MethylIT</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/MethylIT.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/cancer_example.html">Example of Methylome Analysis with MethylIT using Cancer Datasets</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Report the Best Fitted Probability Distribution Model</h1>
    
    <div class="hidden name"><code>gofReport.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>In Methyl-IT,  the signal detection step requires for the
knowledge of the probability distribution of the methylation noise, which
is the null hypothesis used to discriminate the signal from the noise.
Both, signal and noise, are expressed in terms of an information
divergence of methylation levels, which (currently in Methyl-IT) could be
the Hellinger divergence or the total variation distance.</p><pre>As shown in reference [1], on statistical physics basis, the probability
distribution of the noise is a member of the generalized gamma
distribution. In particular, if the methylation changes on the DNA
molecule follow a Poisson process, then the noise follows a Weibull
probability distribution.

Function 'gofReport' search for the best fitted model betweeen the set
of models requested by the user. Two goodness-of-fit (GoF) criteria are
applied to select the best fitted model: Akaike's information criterion
(AIC) and the correlation coeficient of cross-validations for the
nonlinear regressions (R.Cross.val) [2]. These criteria evaluate
different information inferred from the models. AIC deals with the
trade-off between the goodness of fit of the model and the complexity
of the model, while R.Cross.val provides information on the prediction
power/performance of the model when confronted with external dataset.

Although the numerical algorithms to accomplish the nonlinear fit are not
perfect, in general, the model with the lowest AIC must have the highest
R.Cross.val. If the model with the lowest AIC has not the highest
R.Cross.val, then further analyses are required. These analyses could
include the visualization of the graphics for the density distribution,
evaluation of whether the parameter values can be meaningful or not, etc.
Nevertheless, the best model will, in general, lead to the identification
of the greater amount of potential DMPs and DMPs, as well as, the highest
classification accuracy estimated with functions
\code{\link{estimateCutPoint}} and \code{\link{evaluateDIMPclass}}. In
the worse scenario, these observations can ultimately lead to a post-hoc
decision on which the best model is.
</pre>

    </div>

    <pre class="usage"><span class='fu'>gofReport</span>(
  <span class='no'>HD</span>,
  <span class='kw'>model</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"Weibull2P"</span>, <span class='st'>"Weibull3P"</span>, <span class='st'>"Gamma2P"</span>, <span class='st'>"Gamma3P"</span>),
  <span class='kw'>column</span> <span class='kw'>=</span> <span class='fl'>9</span>,
  <span class='kw'>absolute</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>output</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"best.model"</span>, <span class='st'>"all"</span>),
  <span class='kw'>confl_model</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>num.cores</span> <span class='kw'>=</span> <span class='fl'>1L</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>HD</th>
      <td><p>An "InfDiv" object returned by function
<code><a href='estimateDivergence.html'>estimateDivergence</a></code>.</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>A character vector naming the models to fit. Default is
model = c("Weibull2P", "Weibull3P", "Gamma2P", "Gamma3P"). See
<code><a href='nonlinearFitDist.html'>nonlinearFitDist</a></code> for more options.</p></td>
    </tr>
    <tr>
      <th>column</th>
      <td><p>An integer number denoting the index of the GRanges column where
the information divergence is given. Default column = 9, which is the
column where the Hellinger divergence values are reported (by default) by
function <code><a href='estimateDivergence.html'>estimateDivergence</a></code>.</p></td>
    </tr>
    <tr>
      <th>absolute</th>
      <td><p>Logic (default, FALSE). Total variation (TV, the difference
of methylation levels) is normally an output in the downstream MethylIT
analysis. If 'absolute = TRUE', then TV is transformed into |TV|, which
is an information divergence that can be fitted as well.</p></td>
    </tr>
    <tr>
      <th>output</th>
      <td><p>If output == "all", the table with the GoF statistics is
returned in a list together with the best fitted model and the
corresponding statistics. Default is "best.model"</p></td>
    </tr>
    <tr>
      <th>confl_model</th>
      <td><p>Logic. If TRUE, then the best model based on highest
R.Cross.val is returned for those samples where the model(s) with lowest
AIC has not the highest R.Cross.val.</p></td>
    </tr>
    <tr>
      <th>num.cores</th>
      <td><p>The number of cores to use in the nonlinear fit step, i.e.
at most how many child processes will be run simultaneously (see
<code><a href='https://rdrr.io/pkg/BiocParallel/man/bplapply.html'>bplapply</a></code> function from BiocParallel package).</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>If TRUE, prints the function log to stdout</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments to pass to <code><a href='nonlinearFitDist.html'>nonlinearFitDist</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If 'output = "best.model"', a character vector with the name of the
best fitted model for each sample and model statistics, which can be used
the next step to get the potential DMPs with function
<code><a href='getPotentialDIMP.html'>getPotentialDIMP</a></code>. Otherwise, it will return a list with the
table carrying the GoF values and the previously mentioned data.</p><pre>The best model selection is based on the lowest AIC. However, if
'confl_model = TRUE', then the returned list will contain a sublist named
'confl_model' with the best model selected based on the highest
R.Cross.val. This sublist is returned only if at least there is one
sample where the model with the lowest AIC has not the highest
R.Cross.val. This report is useful to analyse any conflict between
models. For example, some times the best model selected based on AIC has
a R.Cross.val = 0.99945, while the higest R.Cross.val is 0.99950. In such
a situation the model with lowest AIC is still fine. However, some times
the model with the best AIC has some meaningless paramater value. For
example,  scale = 0.0000000001 in 'GGamm3P' or in 'Weibull2P' models.
This last situation can result from the numerical algorithm used in
the parameter estimation. The numerical algorithms for nonlinear fit
estimation are not perfect!
</pre>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
<pre>\enumerate{
    \item R. Sanchez and S. A. Mackenzie, “Information Thermodynamics of
        Cytosine DNA Methylation,” PLoS One, vol. 11, no. 3, p. e0150427,
        Mar. 2016.
    \item Stevens JP. Applied Multivariate Statistics for the Social
        Sciences. Fifth Edit. Routledge Academic; 2009.
}
</pre>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='nonlinearFitDist.html'>nonlinearFitDist</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Loading information divergence dataset</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>HD</span>)
<span class='co'>## Subsetting object HD (for the sake of runnig a faster example)</span>
<span class='no'>hd</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='lapply.html'>lapply</a></span>(<span class='no'>HD</span>, <span class='kw'>function</span>(<span class='no'>x</span>) <span class='no'>x</span>[<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span>(<span class='fl'>100</span>)], <span class='kw'>keep.attr</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='co'>## The GoF report</span>
<span class='no'>dt</span> <span class='kw'>&lt;-</span> <span class='fu'>gofReport</span>(<span class='no'>hd</span>)</div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |==================                                                    |  25%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================================                  |  75%  |                                                                              |======================================================================| 100%
#&gt; 
#&gt;  *** Creating report ... </div><div class='output co'>#&gt; <span class='warning'>Warning: The best fitted model for sample(s) T1 require(s) for further analysis. </span>
#&gt; <span class='warning'>The model with the lowest AIC must have the highest R.Cross.val</span></div><div class='output co'>#&gt;      w2p_AIC w2p_R.Cross.val   w3p_AIC w3p_R.Cross.val   g2p_AIC
#&gt; C1 -455.0259       0.9963849        NA              NA -437.3394
#&gt; C2 -426.8983       0.9951161 -431.1954       0.9956952 -409.3027
#&gt; C3 -582.1629       0.9990002        NA              NA -560.5544
#&gt; T1 -494.5917       0.9975048 -493.8734       0.9975519 -461.7047
#&gt; T2 -472.0464       0.9971160        NA              NA -477.2328
#&gt; T3 -517.5384       0.9980853 -515.9888       0.9981240 -493.3195
#&gt;    g2p_R.Cross.val   g3p_AIC g3p_R.Cross.val      bestModel
#&gt; C1       0.9958804 -434.8702       0.9958220            w2p
#&gt; C2       0.9950139 -411.1744       0.9953230            w3p
#&gt; C3       0.9988600 -559.6221       0.9987277            w2p
#&gt; T1       0.9970319 -484.9045       0.9974664 Needs revision
#&gt; T2       0.9974107 -481.0623       0.9975013            g3p
#&gt; T3       0.9977381 -526.9134       0.9983114            g3p
#&gt; </div><div class='input'>
<span class='co'>## To get the potential DMPs</span>
<span class='no'>ps_dmp</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='getPotentialDIMP.html'>getPotentialDIMP</a></span>(<span class='kw'>LR</span> <span class='kw'>=</span> <span class='no'>hd</span>, <span class='kw'>nlms</span> <span class='kw'>=</span> <span class='no'>dt</span>$<span class='no'>nlms</span>, <span class='kw'>div.col</span> <span class='kw'>=</span> <span class='fl'>9L</span>,
                            <span class='kw'>dist.name</span> <span class='kw'>=</span> <span class='no'>dt</span>$<span class='no'>bestModel</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Robersy Sanchez 11/25/2019 <a href='https://github.com/genomaths'>https://github.com/genomaths</a></p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Robersy Sanchez.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


